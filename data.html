<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard - LaggyWorld</title>
</head>
<body>
  <header>
    <a href="index.html" style="text-decoration: none; color: inherit;">
      <h1>LaggyWorld</h1>
    </a>
    <nav>
      <a href="">Features/Pricing</a>
      <a href="signup.html">Signup</a>
      <a href="contact.html">Contact</a>
      <a href="data.html">Account/Dashboard</a>
    </nav>
  </header>
  <main>
    <h2>Your Dashboard</h2>
    <section id="profileCard" style="display: flex; align-items: center; gap: 20px; border: 1px solid #ccc; padding: 20px; max-width: 500px;">
      <img id="pfp" src="https://via.placeholder.com/100" alt="Profile Picture" width="100" height="100" style="border-radius: 50%;">
      <div>
        <p><strong>Username:</strong> <span id="username">Loading...</span></p>
        <p><strong>Email:</strong> <span id="email">Loading...</span></p>
      </div>
    </section>
    <br>
    <section id="serverDashboard">
      <h3>Your Servers</h3>
      <div id="servers">
        <p>Loading servers...</p>
      </div>
    </section>
    <br>
    <section id="settings">
      <h3>Settings</h3>
      <p><em>Settings options coming soon (change password, upload PFP, delete account, etc.)</em></p>
    </section>
    <br>
    <button onclick="logout()">Logout</button>
  </main>
  <footer>
    <p>© 2025 LaggyWorld Hosting. All rights reserved.</p>
  </footer>
  <script>
    auth.onAuthStateChanged(async (user) => {
      if (user) {
        const doc = await db.collection("users").doc(user.uid).get();
        const data = doc.data();

        const pfpUrl = data.pfpUrl || "https://via.placeholder.com/100";
        document.getElementById("pfp").src = pfpUrl;
        document.getElementById("username").textContent = data.username;
        document.getElementById("email").textContent = data.email;

        // Server Dashboard (example: fetching user's servers)
        const serversRef = await db.collection("servers").where("owner", "==", user.uid).get();
        const serversDiv = document.getElementById("servers");
        if (serversRef.empty) {
          serversDiv.innerHTML = "<p>You have no servers yet.</p>";
        } else {
          let html = "<ul>";
          serversRef.forEach(doc => {
            const server = doc.data();
            html += `<li><strong>${server.name}</strong> – ${server.status || "offline"}</li>`;
          });
          html += "</ul>";
          serversDiv.innerHTML = html;
        }

      } else {
        window.location.href = "login.html";
      }
    });

    function logout() {
      auth.signOut().then(() => window.location.href = "login.html");
    }
  </script>
</body>
</html>
